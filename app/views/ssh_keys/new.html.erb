<% content_for :title, "Add SSH Key" %>

<div class="container-fluid">
  <!-- Header -->
  <div class="row mb-4">
    <div class="col">
      <div class="d-flex justify-content-between align-items-center">
        <div>
          <h1 class="h3 mb-1 text-gray-800">
            <i class="fas fa-plus me-2 text-primary"></i>
            Add SSH Key
          </h1>
          <p class="text-muted mb-0">Add a new SSH public key for server access</p>
        </div>
        <div>
          <%= link_to ssh_keys_path, class: "btn btn-outline-secondary" do %>
            <i class="fas fa-arrow-left me-2"></i>Back to SSH Keys
          <% end %>
        </div>
      </div>
    </div>
  </div>

  <div class="row">
    <!-- Form -->
    <div class="col-md-8">
      <div class="card shadow">
        <div class="card-header py-3">
          <h6 class="m-0 font-weight-bold text-primary">
            <i class="fas fa-key me-2"></i>SSH Key Information
          </h6>
        </div>
        <div class="card-body">
          <%= form_with model: @ssh_key, local: true, class: "needs-validation", novalidate: true do |form| %>
            <div class="row">
              <div class="col-md-12 mb-3">
                <%= form.label :name, class: "form-label" %>
                <%= form.text_field :name, class: "form-control #{'is-invalid' if @ssh_key.errors[:name].any?}", 
                    placeholder: "e.g., Work Laptop, Home Desktop, CI/CD Key" %>
                <% if @ssh_key.errors[:name].any? %>
                  <div class="invalid-feedback">
                    <%= @ssh_key.errors[:name].first %>
                  </div>
                <% end %>
                <div class="form-text">Choose a descriptive name to identify this key</div>
              </div>
            </div>

            <div class="row">
              <div class="col-md-12 mb-3">
                <%= form.label :public_key, "SSH Public Key", class: "form-label" %>
                <%= form.text_area :public_key, rows: 4, class: "form-control #{'is-invalid' if @ssh_key.errors[:public_key].any?}", 
                    placeholder: "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC... user@hostname" %>
                <% if @ssh_key.errors[:public_key].any? %>
                  <div class="invalid-feedback">
                    <%= @ssh_key.errors[:public_key].first %>
                  </div>
                <% end %>
                <div class="form-text">
                  Paste your SSH public key here. It should start with ssh-rsa, ssh-ed25519, or similar.
                  <br><strong>Never share your private key!</strong>
                </div>
              </div>
            </div>

            <div class="row">
              <div class="col-md-6 mb-3">
                <%= form.label :expires_at, "Expiration Date (Optional)", class: "form-label" %>
                <%= form.datetime_local_field :expires_at, class: "form-control #{'is-invalid' if @ssh_key.errors[:expires_at].any?}" %>
                <% if @ssh_key.errors[:expires_at].any? %>
                  <div class="invalid-feedback">
                    <%= @ssh_key.errors[:expires_at].first %>
                  </div>
                <% end %>
                <div class="form-text">Leave empty for no expiration</div>
              </div>
            </div>

            <div class="row">
              <div class="col-md-12">
                <div class="d-flex gap-2">
                  <%= form.submit "Add SSH Key", class: "btn btn-primary" %>
                  <%= link_to "Cancel", ssh_keys_path, class: "btn btn-secondary" %>
                </div>
              </div>
            </div>
          <% end %>
        </div>
      </div>
    </div>

    <!-- Help Sidebar -->
    <div class="col-md-4">
      <div class="card shadow">
        <div class="card-header py-3">
          <h6 class="m-0 font-weight-bold text-primary">
            <i class="fas fa-question-circle me-2"></i>How to Generate SSH Keys
          </h6>
        </div>
        <div class="card-body">
          <h6>On Linux/macOS:</h6>
          <div class="bg-dark text-white p-3 rounded mb-3">
            <code class="text-white">ssh-keygen -t ed25519 -C "your_email@example.com"</code>
          </div>
          
          <h6>On Windows (PowerShell):</h6>
          <div class="bg-dark text-white p-3 rounded mb-3">
            <code class="text-white">ssh-keygen -t ed25519 -C "your_email@example.com"</code>
          </div>
          
          <h6>View your public key:</h6>
          <div class="bg-dark text-white p-3 rounded mb-3">
            <code class="text-white">cat ~/.ssh/id_ed25519.pub</code>
          </div>
          
          <div class="alert alert-warning">
            <i class="fas fa-exclamation-triangle me-2"></i>
            <strong>Important:</strong> Only share your public key (.pub file). Never share your private key!
          </div>
          
          <div class="alert alert-info">
            <i class="fas fa-info-circle me-2"></i>
            <strong>Tip:</strong> Ed25519 keys are recommended for better security and performance.
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<style>
.text-gray-800 {
  color: #5a5c69 !important;
}
.card {
  box-shadow: 0 0.15rem 1.75rem 0 rgba(58, 59, 69, 0.15) !important;
}
</style>